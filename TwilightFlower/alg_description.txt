1 internal(main)    key
2 security(hidden)  key
3 external(user's)  key
4 shadow(temporary) key

1 запуск:
* выгружается в озу ключи 1 и 2 далее 1.1 и 2.1
* ключом 3 расшифровывается ключ 2.1 и 2.1 расшифровывает 1.1
* генерируется ключ 4
* ключ 4 шифрует ключ 2

* любые действия пользователя

* далее 
если приходит команда halt - 1.1(пункт)
и если не приходит команда halt - 1.2(пункт)

1.1

ключ 2 расшифровывается ключом 4
ключ 4 стирается
удаляются ключи 1.1 2.1 3
можно выключать питание

1.2

при выключении питания без команды halt
удаляются ключи 1.1 2.1 3 и 4
соответственно при следующем включении ключ 2 остается зашифрованным и становится невозможно расшифровать ключи 1 и 2
